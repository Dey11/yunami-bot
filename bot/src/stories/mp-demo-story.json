{
  "id": "mp-demo-story",
  "title": "The Heist",
  "description": "A multiplayer heist story demonstrating shared voting, arc splits, DMs, and reunions.",
  "min_party_size": 2,
  "max_party_size": 4,
  "supports_solo": false,
  "firstNodeId": "intro",
  "nodes": {
    "intro": {
      "id": "intro",
      "schema_version": 1,
      "type": "narrative",
      "title": "The Briefing",
      "tags": ["intro", "all-players"],
      "public_embed": {
        "title": "üèõÔ∏è The Vault Job",
        "description": "Your crew gathers in the dimly lit warehouse. The target: First National Bank's underground vault.\n\n**Mission Objective:** Secure the contents of Safety Deposit Box #742.\n\nThe mastermind spreads blueprints across the table.",
        "image": "Background.png",
        "footer": "All players present",
        "fields": [
          { "name": "Intel", "value": "Security rotates every 30 minutes. You have a narrow window." }
        ]
      },
      "type_specific": {
        "extra_data": {
          "nextNodeId": "team_vote"
        }
      },
      "preconditions": {
        "min_player_count": 2
      }
    },

    "team_vote": {
      "id": "team_vote",
      "schema_version": 1,
      "type": "timed",
      "title": "Entry Strategy",
      "tags": ["shared", "vote", "all-players"],
      "public_embed": {
        "title": "üó≥Ô∏è Choose Your Entry Point",
        "description": "The crew must decide how to enter the bank. Vote now!",
        "image": "Background.png",
        "footer": "Vote as a team! | Timer active",
        "fields": [
          { "name": "üö™ Front Door", "value": "Bold. Walk in during closing hours disguised as cleaning staff." },
          { "name": "üï≥Ô∏è Underground", "value": "Risky. Tunnel through the old subway maintenance shaft." }
        ]
      },
      "type_specific": {
        "timers": {
          "duration_seconds": 45
        },
        "choices": [
          {
            "id": "front_door",
            "label": "Front Door Approach",
            "nextNodeId": "entry_front"
          },
          {
            "id": "underground",
            "label": "Underground Tunnel",
            "nextNodeId": "entry_tunnel"
          }
        ],
        "outcome_rules": {
          "on_all_inputs_or_timeout": {
            "compute": "majority"
          }
        }
      },
      "preconditions": {
        "min_player_count": 2
      }
    },

    "entry_front": {
      "id": "entry_front",
      "schema_version": 1,
      "type": "narrative",
      "title": "Through the Front",
      "tags": ["shared", "all-players"],
      "public_embed": {
        "title": "üö™ Entering Through the Front",
        "description": "Dressed as cleaning staff, you walk past the security desk. The guard barely glances up from his phone.\n\nYou're in. Now to execute the split plan.",
        "image": "Background.png",
        "footer": "All players"
      },
      "type_specific": {
        "extra_data": {
          "nextNodeId": "group_splits"
        }
      }
    },

    "entry_tunnel": {
      "id": "entry_tunnel",
      "schema_version": 1,
      "type": "narrative",
      "title": "The Tunnel",
      "tags": ["shared", "all-players"],
      "public_embed": {
        "title": "üï≥Ô∏è Through the Tunnels",
        "description": "You crawl through the dark maintenance shaft. Rats scatter as your flashlight sweeps the walls.\n\nYou emerge in the bank's basement. Time to execute the split plan.",
        "image": "Background.png",
        "footer": "All players"
      },
      "type_specific": {
        "extra_data": {
          "nextNodeId": "group_splits"
        }
      }
    },

    "group_splits": {
      "id": "group_splits",
      "schema_version": 1,
      "type": "arc_split",
      "title": "The Split",
      "tags": ["arc-split"],
      "public_embed": {
        "title": "‚ö° Mission Assignments",
        "description": "The plan requires precise timing. Assignments have been issued.\n\n**The Scout** must disable the cameras.\n**The Main Team** must breach the vault mechanism.",
        "image": "Background.png",
        "footer": "Check DMs for secret intel",
        "fields": [
          { "name": "üîç Scout", "value": "Check your DMs for the control room code." },
          { "name": "üõ°Ô∏è Main Team", "value": "Prepare your equipment." }
        ]
      },
      "side_effects_on_enter": {
        "spawn_dm_jobs": true
      },
      "type_specific": {
        "arc_split": {
          "split_mode": "role_based",
          "merge_node_id": "scout_mission",
          "arcs": [
            {
              "id": "solo_scout",
              "label": "Scout",
              "description": "Disable security",
              "player_count": 1,
              "entry_node_id": "scout_mission",
              "required_roles": ["scout"]
            },
            {
              "id": "main_team",
              "label": "Main Team",
              "description": "Breach vault",
              "player_count": "remaining",
              "entry_node_id": "scout_mission"
            }
          ]
        },
        "dm_deliveries": [
          {
            "recipient_role": "scout",
            "content": {
              "text": "üîê **SECRET INTEL** üîê\n\nYou've tapped into the security feed.\n\n**Control Room Override Code: 7-4-2-9**\n\nThe team is relying on you. Do not fail."
            }
          }
        ]
      },
      "preconditions": {
        "min_player_count": 2
      }
    },

    "scout_mission": {
      "id": "scout_mission",
      "schema_version": 1,
      "type": "choice",
      "title": "Scout's Move",
      "tags": ["scout-turn"],
      "public_embed": {
        "title": "üìπ Camera Control Room",
        "description": "The team waits in the shadows while **The Scout** approaches the control terminal.\n\nA guard is fast asleep at the desk.",
        "image": "Background.png",
        "footer": "Waiting for Scout..."
      },
      "type_specific": {
        "choices": [
          {
            "id": "disable_silent",
            "label": "Silently disable (Scout only)",
            "allowed_roles": ["scout"],
            "nextNodeId": "team_breach"
          },
          {
            "id": "disable_loud",
            "label": "Knock out guard (Scout only)",
            "allowed_roles": ["scout"],
            "nextNodeId": "team_breach"
          }
        ]
      }
    },

    "team_breach": {
      "id": "team_breach",
      "schema_version": 1,
      "type": "timed",
      "title": "Vault Breach",
      "tags": ["team-turn"],
      "public_embed": {
        "title": "üîí The Vault Door",
        "description": "Cameras are down! The Scout signals clear.\n\nNow it's up to the **Main Team** to crack the vault door.",
        "image": "Background.png",
        "footer": "Main Team voting..."
      },
      "type_specific": {
        "timers": {
          "duration_seconds": 30
        },
        "choices": [
          {
            "id": "explosives",
            "label": "Use Explosives",
            "nextNodeId": "finale"
          },
          {
            "id": "safecracker",
            "label": "Safecracker Method",
            "nextNodeId": "finale"
          }
        ],
        "outcome_rules": {
          "on_all_inputs_or_timeout": {
            "compute": "majority"
          }
        }
      }
    },

    "finale": {
      "id": "finale",
      "schema_version": 1,
      "type": "narrative",
      "title": "Mission Complete",
      "tags": ["ending"],
      "public_embed": {
        "title": "üí∞ Payday",
        "description": "The vault swings open. You grab the contents of Box #742 and vanish before the police arrive.\n\n**Mission Successful!**\n\nThe crew splits the loot and disappears into the night.",
        "image": "Background.png",
        "footer": "Story Complete"
      }
    }
  }
}
